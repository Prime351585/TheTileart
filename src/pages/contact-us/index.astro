---
import Layout from '../../layouts/Layout.astro';
import { Image } from 'astro:assets';
import contactImage from '../../assets/bannerImage/banner-2.jpg'; // Using the same banner image for consistency
import { getPageSEO } from '../../../graphql/pageSeo';
import { WP_USERNAME, WP_APP_PASSWORD, GRAPH_QL_LINK } from "astro:env/server";

// Fetch SEO data for the home page
const homeSEO = await getPageSEO(GRAPH_QL_LINK, 'contact-us', WP_USERNAME, WP_APP_PASSWORD);

// Use WordPress SEO data or fallback to defaults
const pageTitle = homeSEO?.title || 'Contact TileArt - Get in Touch With Our Team';
const pageDescription = homeSEO?.metaDescription || 'Contact TileArt - Get in Touch With Our Team';

// Define contact information
const contactInfo = [
  {
    icon: "M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 8V5z",
    title: "Call Us",
    details: "+91 9667725508",
    link: "tel:+919667725508"
  },
  {
    icon: "M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z",
    title: "Email Us",
    details: "thetileart0@gmail.com",
    link: "mailto:thetileart0@gmail.com"
  },
  {
    icon: "M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z M15 11a3 3 0 11-6 0 3 3 0 016 0z",
    title: "Visit Us",
    details: "113, Krishi Vihar, Vardhman Vihar, Jaipur",
    link: "https://maps.app.goo.gl/SqZyXv9FqsocMM5d6"
  }
];

// Business hours
const businessHours = [
  { day: "Monday - Friday", hours: "9:00 AM - 6:00 PM" },
  { day: "Saturday", hours: "10:00 AM - 4:00 PM" },
  { day: "Sunday", hours: "Closed" }
];
---

<Layout title={pageTitle} description={pageDescription}>
  <!-- Hero Section -->
  <section class="relative overflow-hidden bg-primary-50">
    <div class="absolute inset-0 z-0">
      <Image 
        src={contactImage} 
        alt="Contact TileArt" 
        class="w-full h-full object-cover opacity-20"
        width={1920}
        height={1080}
      />
    </div>
    <div class="relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-24 md:py-32">
      <div class="max-w-3xl">
        <h1 class="text-4xl md:text-5xl lg:text-6xl font-bold text-primary-900 mb-6">
          Get In Touch
        </h1>
        <p class="text-xl md:text-2xl text-primary-800 mb-8">
          We'd love to hear from you. Reach out for quotes, questions, or collaboration opportunities.
        </p>
      </div>
    </div>
  </section>

  <!-- Contact Info Section -->
  <section class="py-16 md:py-24 bg-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
        {contactInfo.map(item => (
          <a 
            href={item.link} 
            class="bg-primary-50 p-8 rounded-xl shadow-sm hover:shadow-md transition-all group"
          >
            <div class="rounded-full bg-primary-100 w-16 h-16 flex items-center justify-center mb-6 group-hover:bg-primary-200 transition-colors">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-primary-700" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d={item.icon} />
              </svg>
            </div>
            <h3 class="text-xl font-semibold text-primary-900 mb-2">{item.title}</h3>
            <p class="text-gray-700">{item.details}</p>
          </a>
        ))}
      </div>
    </div>
  </section>

  <!-- Contact Form & Map Section -->
  <section class="py-16 md:py-24 bg-primary-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
        <!-- Contact Form -->
        <div class="bg-white p-8 rounded-xl shadow-md">
          <h2 class="text-3xl font-bold text-primary-900 mb-6">Send us a message</h2>
          <p class="text-gray-700 mb-8">
            Fill out the form below and we'll get back to you as soon as possible. You can also reach us directly via WhatsApp.
          </p>
          
          <form id="contact-form" class="space-y-6">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                <label for="name" class="block text-sm font-medium text-gray-700 mb-1">Name</label>
                <input 
                  type="text" 
                  id="name" 
                  name="name" 
                  required
                  class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-primary-600 focus:border-transparent transition-all"
                  placeholder="Your name"
                />
              </div>
              <div>
                <label for="phone" class="block text-sm font-medium text-gray-700 mb-1">Phone</label>
                <input 
                  type="tel" 
                  id="phone" 
                  name="phone" 
                  required
                  class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-primary-600 focus:border-transparent transition-all"
                  placeholder="Your phone number"
                />
              </div>
            </div>
            
            <div>
              <label for="email" class="block text-sm font-medium text-gray-700 mb-1">Email</label>
              <input 
                type="email" 
                id="email" 
                name="email" 
                required
                class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-primary-600 focus:border-transparent transition-all"
                placeholder="Your email address"
              />
            </div>
            
            <div>
              <label for="subject" class="block text-sm font-medium text-gray-700 mb-1">Subject</label>
              <select 
                id="subject" 
                name="subject" 
                required
                class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-primary-600 focus:border-transparent transition-all"
              >
                <option value="" disabled selected>Select a subject</option>
                <option value="Quote Request">Quote Request</option>
                <option value="Product Inquiry">Product Inquiry</option>
                <option value="Installation Question">Installation Question</option>
                <option value="Other">Other</option>
              </select>
            </div>
            
            <div>
              <label for="message" class="block text-sm font-medium text-gray-700 mb-1">Message</label>
              <textarea 
                id="message" 
                name="message" 
                rows="5" 
                required
                class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-primary-600 focus:border-transparent transition-all"
                placeholder="Your message..."
              ></textarea>
            </div>
            
            <div class="flex items-center">
              <input 
                type="checkbox" 
                id="whatsapp-checkbox" 
                name="whatsapp-checkbox" 
                class="h-5 w-5 text-primary-600 border-gray-300 rounded focus:ring-primary-500"
              />
              <label for="whatsapp-checkbox" class="ml-2 block text-sm text-gray-700">
                I prefer to be contacted via WhatsApp
              </label>
            </div>
            
            <div class="flex flex-col sm:flex-row gap-4">
              <button 
                type="submit" 
                id="submit-form" 
                class="inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-lg shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition-colors"
              >
                Send Message
              </button>
              
              <button 
                type="button" 
                id="whatsapp-button" 
                class="inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-lg shadow-sm text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors"
              >
                <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                  <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
                </svg>
                Contact via WhatsApp
              </button>
            </div>
          </form>
        </div>
        
        <!-- Hours & Map -->
        <div class="space-y-12">
          <!-- Business Hours -->
          <div class="bg-white p-8 rounded-xl shadow-md">
            <h3 class="text-2xl font-bold text-primary-900 mb-6 flex items-center">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2 text-primary-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
              Business Hours
            </h3>
            <div class="space-y-3">
              {businessHours.map(item => (
                <div class="flex justify-between pb-2 border-b border-gray-100">
                  <span class="font-medium text-gray-700">{item.day}</span>
                  <span class="text-primary-800">{item.hours}</span>
                </div>
              ))}
            </div>
          </div>
          
          <!-- Map -->
          <div class="bg-white p-8 rounded-xl shadow-md">
            <h3 class="text-2xl font-bold text-primary-900 mb-6 flex items-center">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2 text-primary-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
              </svg>
              Find Us
            </h3>
            <div class="rounded-lg overflow-hidden h-80">
              <!-- Replace with your actual embed code -->
              <iframe 
                src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d444.84917230391056!2d75.73136183610684!3d26.878304999999997!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x396db5006c078105%3A0x920ad96a1352d62!2sKrishi%20vihar%20s%20block!5e0!3m2!1sen!2sin!4v1748260909333!5m2!1sen!2sin" 
                width="100%" 
                height="100%" 
                style="border:0;" 
                allowfullscreen="" 
                loading="lazy"
                class="w-full h-full"
              ></iframe>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- FAQ Section -->
  <section class="py-16 md:py-24 bg-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-16">
        <h2 class="text-3xl md:text-4xl font-bold text-primary-900 mb-4">
          Frequently Asked Questions
        </h2>
        <p class="text-xl text-primary-800 max-w-3xl mx-auto">
          Find quick answers to common questions
        </p>
      </div>
      
      <div class="max-w-3xl mx-auto">
        <div class="space-y-6">
          <div class="bg-primary-50 rounded-lg p-6">
            <button class="faq-toggle flex justify-between items-center w-full text-left" aria-expanded="false">
              <h3 class="text-lg font-medium text-primary-900">How long does shipping take?</h3>
              <svg class="h-6 w-6 text-primary-600 transform transition-transform duration-200" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
              </svg>
            </button>
            <div class="faq-content mt-2 hidden">
              <p class="text-gray-700">
                Shipping typically takes 3-5 business days within the continental US. For international orders, please allow 7-14 business days for delivery.
              </p>
            </div>
          </div>
          
          <div class="bg-primary-50 rounded-lg p-6">
            <button class="faq-toggle flex justify-between items-center w-full text-left" aria-expanded="false">
              <h3 class="text-lg font-medium text-primary-900">Do you offer installation services?</h3>
              <svg class="h-6 w-6 text-primary-600 transform transition-transform duration-200" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
              </svg>
            </button>
            <div class="faq-content mt-2 hidden">
              <p class="text-gray-700">
                Yes, we offer professional installation services in select areas. Please contact us for availability and pricing in your region.
              </p>
            </div>
          </div>
          
          <div class="bg-primary-50 rounded-lg p-6">
            <button class="faq-toggle flex justify-between items-center w-full text-left" aria-expanded="false">
              <h3 class="text-lg font-medium text-primary-900">Can I return tiles if I'm not satisfied?</h3>
              <svg class="h-6 w-6 text-primary-600 transform transition-transform duration-200" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
              </svg>
            </button>
            <div class="faq-content mt-2 hidden">
              <p class="text-gray-700">
                We accept returns of unused, unopened tiles within 30 days of purchase. Custom orders are non-refundable.
              </p>
            </div>
          </div>
          
          <div class="bg-primary-50 rounded-lg p-6">
            <button class="faq-toggle flex justify-between items-center w-full text-left" aria-expanded="false">
              <h3 class="text-lg font-medium text-primary-900">Do you provide samples?</h3>
              <svg class="h-6 w-6 text-primary-600 transform transition-transform duration-200" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
              </svg>
            </button>
            <div class="faq-content mt-2 hidden">
              <p class="text-gray-700">
                Yes, we offer sample kits for most of our collections. Samples can be ordered directly from our website, and the cost of samples can be credited toward your full order.
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</Layout>

<script>
  // WhatsApp functionality
  document.addEventListener('DOMContentLoaded', function() {
    const whatsappButton = document.getElementById('whatsapp-button');
    const contactForm = document.getElementById('contact-form');

// WhatsApp phone number (include country code)
const whatsappNumber = "919667725508"; // Replace with your actual WhatsApp number

    // Handle WhatsApp button click
    whatsappButton?.addEventListener('click', function() {
      const nameInput = document.getElementById('name') as HTMLInputElement;
      const phoneInput = document.getElementById('phone') as HTMLInputElement;
      const emailInput = document.getElementById('email') as HTMLInputElement;
      const subjectInput = document.getElementById('subject') as HTMLSelectElement;
      const messageInput = document.getElementById('message') as HTMLTextAreaElement;
      
      // Validate form
      if (!nameInput.value || !phoneInput.value || !messageInput.value) {
        alert('Please fill out at least your name, phone number, and message.');
        return;
      }
      
      // Construct WhatsApp message
      const whatsappMessage = 
        `Hello TileArt, my name is ${nameInput.value}. ` +
        `${subjectInput.value ? 'Subject: ' + subjectInput.value + '. ' : ''}` +
        `${messageInput.value}` +
        `${emailInput.value ? '\n\nYou can also reach me at: ' + emailInput.value : ''}`;
      
      // Encode message for URL
      const encodedMessage = encodeURIComponent(whatsappMessage);
      
      // Create WhatsApp URL
      const whatsappUrl = `https://wa.me/${whatsappNumber}?text=${encodedMessage}`;
      
      // Open WhatsApp in new window
      window.open(whatsappUrl, '_blank');
    });
    
    // Handle form submission
    contactForm?.addEventListener('submit', function(e) {
      e.preventDefault();
      
      const whatsappCheckbox = document.getElementById('whatsapp-checkbox') as HTMLInputElement;
      
      // If WhatsApp is preferred, trigger WhatsApp button click
      if (whatsappCheckbox.checked) {
        whatsappButton?.click();
      } else {
        whatsappButton?.click();
        // // Regular form submission - you would add AJAX submission code here
        // alert('Form submitted! In a real implementation, this would be sent to your server.');
        // contactForm.reset();
      }
    });
    
    // FAQ toggles - Fixed implementation
    const faqToggles = document.querySelectorAll('.faq-toggle');
    
    faqToggles.forEach(toggle => {
      toggle.addEventListener('click', function() {
        const content = this.nextElementSibling as HTMLElement;
        const isExpanded = this.getAttribute('aria-expanded') === 'true';
        const icon = this.querySelector('svg');
        
        // Toggle expanded state
        this.setAttribute('aria-expanded', (!isExpanded).toString());
        
        // Toggle content visibility with proper animation
        if (isExpanded) {
          // First remove visibility, then add hidden class after animation
          content.style.maxHeight = '0';
          content.style.opacity = '0';
          
          setTimeout(() => {
            content.classList.add('hidden');
          }, 300); // Match duration to your CSS transition
          
          icon?.classList.remove('rotate-180');
        } else {
          // First make visible but with 0 height, then animate
          content.classList.remove('hidden');
          
          // Force browser to recognize the element before animating
          setTimeout(() => {
            content.style.maxHeight = content.scrollHeight + 'px';
            content.style.opacity = '1';
            icon?.classList.add('rotate-180');
          }, 10);
        }
      });
    });
  });
</script>